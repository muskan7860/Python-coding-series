import boto3
from botocore.exceptions import ClientError

class AWSUtils:
    def __init__(self, region="ap-south-1"):
        self.region = region
        self.s3 = self.get_connection("s3")
        self.ec2 = self.get_connection("ec2")

    def get_connection(self, service):
        return boto3.client(service, region_name=self.region)

    def show_buckets(self):
        response = self.s3.list_buckets()
        for bucket in response["Buckets"]:
            print(bucket["Name"])

    def create_bucket(self, bucket_name):
        try:
            response = self.s3.create_bucket(
                Bucket=bucket_name,
                CreateBucketConfiguration={
                    "LocationConstraint": self.region
                }
            )
            print("✅ Bucket created successfully")

        except ClientError as e:
            print(f"❌ AWS Error: {e}")

    def show_regions(self):
        response = self.ec2.describe_regions()
        for region in response["Regions"]:
            print(region["RegionName"])

    def upload_to_bucket(self, file_path, bucket_name, key_name):
        try:
            self.s3.upload_file(file_path, bucket_name, key_name)
            print("✅ File uploaded successfully")
        except ClientError as e:
            print(f"❌ Upload failed: {e}")

if __name__ == "__main__":
    aws = AWSUtils()
    aws.show_buckets()
    aws.show_regions()
